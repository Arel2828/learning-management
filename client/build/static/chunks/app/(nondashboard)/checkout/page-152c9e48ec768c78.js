(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9940],{67202:(e,t,s)=>{Promise.resolve().then(s.bind(s,67973))},67973:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>z});var r=s(57437),a=s(2857),n=s(49354),i=s(22468),c=s(2265);let o=e=>{let{currentStep:t}=e;return(0,r.jsx)("div",{className:"wizard-stepper",children:(0,r.jsx)("div",{className:"wizard-stepper__container",children:[1,2,3].map((e,s)=>(0,r.jsxs)(c.Fragment,{children:[(0,r.jsxs)("div",{className:"wizard-stepper__step",children:[(0,r.jsx)("div",{className:(0,n.cn)("wizard-stepper__circle",{"wizard-stepper__circle--completed":t>e||3===t&&3===e,"wizard-stepper__circle--current":t===e&&3!==e,"wizard-stepper__circle--upcoming":t<e}),children:t>e||3===t&&3===e?(0,r.jsx)(i.Z,{className:"w-5 h-5"}):(0,r.jsx)("span",{children:e})}),(0,r.jsxs)("p",{className:(0,n.cn)("wizard-stepper__text",{"wizard-stepper__text--active":t>=e,"wizard-stepper__text--inactive":t<e}),children:[1===e&&"Details",2===e&&"Payment",3===e&&"Completion"]})]}),s<2&&(0,r.jsx)("div",{className:(0,n.cn)("wizard-stepper__line",{"wizard-stepper__line--completed":t>e,"wizard-stepper__line--incomplete":t<=e})})]},e))})})};var l=s(5267),d=s(66648),u=s(68756);let p=e=>{let{course:t}=e,s=(0,n.T4)(t.price);return(0,r.jsxs)("div",{className:"course-preview",children:[(0,r.jsxs)("div",{className:"course-preview__container",children:[(0,r.jsx)("div",{className:"course-preview__image-wrapper",children:(0,r.jsx)(d.default,{src:t.image||"/placeholder.png",alt:"Course Preview",width:640,height:360,className:"w-full"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"course-preview__title",children:t.title}),(0,r.jsxs)("p",{className:"text-gray-400 text-md mb-4",children:["by ",t.teacherName]}),(0,r.jsx)("p",{className:"text-sm text-customgreys-dirtyGrey",children:t.description})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-white-50/90 font-semibold mb-2",children:"Course Content"}),(0,r.jsx)(u.Z,{sections:t.sections})]})]}),(0,r.jsxs)("div",{className:"course-preview__container",children:[(0,r.jsx)("h3",{className:"text-xl mb-4",children:"Price Details (1 item)"}),(0,r.jsxs)("div",{className:"flex justify-between mb-4 text-customgreys-dirtyGrey text-base",children:[(0,r.jsxs)("span",{className:"font-bold",children:["1x ",t.title]}),(0,r.jsx)("span",{className:"font-bold",children:s})]}),(0,r.jsxs)("div",{className:"flex justify-between border-t border-customgreys-dirtyGrey pt-4",children:[(0,r.jsx)("span",{className:"font-bold text-lg",children:"Total Amount"}),(0,r.jsx)("span",{className:"font-bold text-lg",children:s})]})]})]})};var m=s(16552),h=s(7493),v=s(51994),x=s(16463);let y=()=>{var e;let t=null!==(e=(0,x.useSearchParams)().get("id"))&&void 0!==e?e:"",{data:s,...r}=(0,v.Ky)(t);return{course:s,courseId:t,...r}},f=()=>{let{course:e,isLoading:t,isError:s}=y(),n="true"===(0,x.useSearchParams)().get("showSignUp");return t?(0,r.jsx)(a.Z,{}):s?(0,r.jsx)("div",{children:"Failed to fetch course data"}):e?(0,r.jsx)("div",{className:"checkout-details",children:(0,r.jsxs)("div",{className:"checkout-details__container",children:[(0,r.jsx)("div",{className:"checkout-details__preview",children:(0,r.jsx)(p,{course:e})}),(0,r.jsx)("div",{className:"checkout-details__auth",children:n?(0,r.jsx)(h.default,{}):(0,r.jsx)(m.default,{})})]})}):(0,r.jsx)("div",{children:" Course is not found "})};var g=s(7345);let _=(0,s(13537).J)("pk_test_51QZTyQKu3uyFp4QqOWt6NftQeUfVymnvaW34gdLVuAPB4TFIjpp4JzXDNSwDgUXGZm4WNjZrLFr4LiSQHQklryI0005umwkuHu"),j={theme:"stripe",variables:{colorPrimary:"#0570de",colorBackground:"#18181b",colorText:"#d2d2d2",colorDanger:"#df1b41",colorTextPlaceholder:"#6e6e6e",fontFamily:"Inter, system-ui, sans-serif",spacingUnit:"3px",borderRadius:"10px",fontSizeBase:"14px"}},N=e=>{let{children:t}=e,[s,n]=(0,c.useState)(""),[i]=(0,v.S5)(),{course:o}=y();return((0,c.useEffect)(()=>{o&&(async()=>{var e;n((await i({amount:null!==(e=null==o?void 0:o.price)&&void 0!==e?e:0x9184e729fff}).unwrap()).clientSecret)})()},[i,null==o?void 0:o.price,o]),s)?(0,r.jsx)(g.Elements,{stripe:_,options:{clientSecret:s,appearance:j},children:t},s):(0,r.jsx)(a.Z,{})},w=()=>{var e,t;let s=(0,x.useRouter)(),r=(0,x.useSearchParams)(),{isLoaded:a,isSignedIn:n}=(0,l.aF)(),i=null!==(e=r.get("id"))&&void 0!==e?e:"",o=parseInt(null!==(t=r.get("step"))&&void 0!==t?t:"1",10),d=(0,c.useCallback)(e=>{let t=Math.min(Math.max(1,e),3),r=n?"true":"false";s.push("/checkout?step=".concat(t,"&id=").concat(i,"&showSignUp=").concat(r),{scroll:!1})},[i,n,s]);return(0,c.useEffect)(()=>{a&&!n&&o>1&&d(1)},[a,n,o,d]),{checkoutStep:o,navigateToStep:d}};var b=s(88592),C=s(89733),S=s(27776);let U=()=>{let e=(0,g.useStripe)(),t=(0,g.useElements)(),[s]=(0,v.Dx)(),{navigateToStep:a}=w(),{course:n,courseId:i}=y(),{user:c}=(0,l.aF)(),{signOut:o}=(0,l.ll)(),d=async r=>{var o;if(r.preventDefault(),!e||!t){S.A.error("Stripe service is not available");return}let l=await e.confirmPayment({elements:t,confirmParams:{return_url:"".concat("http://localhost:3000/checkout?step=3","?id=").concat(i)},redirect:"if_required"});if((null===(o=l.paymentIntent)||void 0===o?void 0:o.status)==="succeeded"){let e={transactionId:l.paymentIntent.id,userId:null==c?void 0:c.id,courseId:i,paymentProvider:"stripe",amount:(null==n?void 0:n.price)||0};await s(e),a(3)}},u=async()=>{await o(),a(1)};return n?(0,r.jsxs)("div",{className:"payment",children:[(0,r.jsxs)("div",{className:"payment__container",children:[(0,r.jsx)("div",{className:"payment__preview",children:(0,r.jsx)(p,{course:n})}),(0,r.jsx)("div",{className:"payment__form-container",children:(0,r.jsx)("form",{id:"payment-form",onSubmit:d,className:"payment__form",children:(0,r.jsxs)("div",{className:"payment__content",children:[(0,r.jsx)("h1",{className:"payment__title",children:"Checkout"}),(0,r.jsx)("p",{className:"payment__subtitle",children:"Fill out the payment details below to complete your purchase."}),(0,r.jsxs)("div",{className:"payment__method",children:[(0,r.jsx)("h3",{className:"payment__method-title",children:"Payment Method"}),(0,r.jsxs)("div",{className:"payment__card-container",children:[(0,r.jsxs)("div",{className:"payment__card-header",children:[(0,r.jsx)(b.Z,{size:24}),(0,r.jsx)("span",{children:"Credit/Debit Card"})]}),(0,r.jsx)("div",{className:"payment__card-element",children:(0,r.jsx)(g.PaymentElement,{})})]})]})]})})})]}),(0,r.jsxs)("div",{className:"payment__actions",children:[(0,r.jsx)(C.z,{className:"hover:bg-white-50/10",onClick:u,variant:"outline",type:"button",children:"Switch Account"}),(0,r.jsx)(C.z,{form:"payment-form",type:"submit",className:"payment__submit",disabled:!e||!t,children:"Pay with Credit Card"})]})]}):null},P=()=>(0,r.jsx)(N,{children:(0,r.jsx)(U,{})});var T=s(87138);let k=()=>(0,r.jsxs)("div",{className:"completion",children:[(0,r.jsxs)("div",{className:"completion__content",children:[(0,r.jsx)("div",{className:"completion__icon",children:(0,r.jsx)(i.Z,{className:"w-16 h-16"})}),(0,r.jsx)("h1",{className:"completion__title",children:"COMPLETED"}),(0,r.jsx)("p",{className:"completion__message",children:"You have successfully made a course purchase!"})]}),(0,r.jsx)("div",{className:"completion__support",children:(0,r.jsxs)("p",{children:["Need help? Contact our"," ",(0,r.jsx)(C.z,{variant:"link",asChild:!0,className:"p-0 m-0 text-primary-700",children:(0,r.jsx)("a",{href:"mailto:support@example.com",children:"customer support"})}),"."]})}),(0,r.jsx)("div",{className:"completion__action",children:(0,r.jsx)(T.default,{href:"user/courses",children:" Go to Courses"})})]}),z=()=>{let{isLoaded:e}=(0,l.aF)(),{checkoutStep:t}=w();return e?(0,r.jsxs)("div",{className:"checkout__content",children:[(0,r.jsx)(o,{currentStep:t}),(0,r.jsx)("div",{className:"checkout__content",children:(()=>{switch(t){case 1:return(0,r.jsx)(f,{});case 2:return(0,r.jsx)(P,{});case 3:return(0,r.jsx)(k,{});case 4:return"checkout details page"}})()})]}):(0,r.jsx)(a.Z,{})}},68756:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var r=s(57437),a=s(2265),n=s(64756),i=s(42421),c=s(49354);let o=n.fC,l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.ck,{ref:t,className:(0,c.cn)("border-b",s),...a})});l.displayName="AccordionItem";let d=a.forwardRef((e,t)=>{let{className:s,children:a,...o}=e;return(0,r.jsx)(n.h4,{className:"flex",children:(0,r.jsxs)(n.xz,{ref:t,className:(0,c.cn)("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",s),...o,children:[a,(0,r.jsx)(i.Z,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})})});d.displayName=n.xz.displayName;let u=a.forwardRef((e,t)=>{let{className:s,children:a,...i}=e;return(0,r.jsx)(n.VY,{ref:t,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...i,children:(0,r.jsx)("div",{className:(0,c.cn)("pb-4 pt-0",s),children:a})})});u.displayName=n.VY.displayName;var p=s(22023);let m=e=>{let{sections:t}=e;return(0,r.jsx)(o,{type:"multiple",className:"w-full",children:t.map(e=>(0,r.jsxs)(l,{value:e.sectionTitle,className:"accordion-section",children:[(0,r.jsx)(d,{className:"accordion-section__trigger",children:(0,r.jsx)("h5",{className:"accordion-section__title",children:e.sectionTitle})}),(0,r.jsx)(u,{className:"accordion-section__content",children:(0,r.jsx)("ul",{children:e.chapters.map(e=>(0,r.jsxs)("li",{className:"accordion-section__chapter",children:[(0,r.jsx)(p.Z,{className:"mr-2 w-4 h-4"}),(0,r.jsx)("span",{className:"text-sm",children:e.title})]},e.chapterId))})})]},e.sectionId))})}},2857:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var r=s(57437),a=s(3274);s(2265);let n=()=>(0,r.jsxs)("div",{className:"loading",children:[(0,r.jsx)(a.Z,{className:"loading__spinner"}),(0,r.jsx)("span",{className:"loading__text",children:"Loading..."})]})},16552:(e,t,s)=>{"use strict";s.d(t,{default:()=>c});var r=s(57437),a=s(5267),n=s(47471),i=s(16463);s(2265);let c=()=>{let{user:e}=(0,a.aF)(),t=(0,i.useSearchParams)(),s=null!==t.get("showSignUp"),c=t.get("id");return(0,r.jsx)(n.SignIn,{signUpUrl:s?"/checkout?step=1&id=".concat(c,"&showSignUp=true"):"/signup",forceRedirectUrl:(()=>{var t;return s?"/checkout?step=2&id=".concat(c,"&showSignUp=true"):"teacher"===(null==e?void 0:null===(t=e.publicMetadata)||void 0===t?void 0:t.userType)?"/teacher/courses":"/user/courses"})(),routing:"hash",afterSignOutUrl:"/"})}},7493:(e,t,s)=>{"use strict";s.d(t,{default:()=>c});var r=s(57437),a=s(5267),n=s(47471),i=s(16463);s(2265);let c=()=>{let{user:e}=(0,a.aF)(),t=(0,i.useSearchParams)(),s=null!==t.get("showSignUp"),c=t.get("id");return(0,r.jsx)(n.SignUp,{signInUrl:s?"/checkout?step=1&id=".concat(c,"&showSignUp=false"):"/signin",forceRedirectUrl:(()=>{var t;return s?"/checkout?step=2&id=".concat(c,"&showSignUp=false"):"teacher"===(null==e?void 0:null===(t=e.publicMetadata)||void 0===t?void 0:t.userType)?"/teacher/courses":"/user/courses"})(),routing:"hash",afterSignOutUrl:"/"})}},89733:(e,t,s)=>{"use strict";s.d(t,{z:()=>l});var r=s(57437),a=s(2265),n=s(71538),i=s(13027),c=s(49354);let o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=a.forwardRef((e,t)=>{let{className:s,variant:a,size:i,asChild:l=!1,...d}=e,u=l?n.g7:"button";return(0,r.jsx)(u,{className:(0,c.cn)(o({variant:a,size:i,className:s})),ref:t,...d})});l.displayName="Button"},49354:(e,t,s)=>{"use strict";s.d(t,{E3:()=>u,G_:()=>l,QG:()=>d,T4:()=>o,cn:()=>c,kg:()=>p});var r=s(44839),a=s(96164),n=s(59772),i=s(27776);function c(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,r.W)(t))}function o(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format((e||0)/100)}function l(e){return((e||0)/100).toString()}n.Z_().transform(e=>{let t=parseFloat(e);return isNaN(t)?"0":(function(e){return Math.round(100*("string"==typeof e?parseFloat(e):e))})(t).toString()});let d=[{value:"N-5",label:"N-5"},{value:"N-4",label:"N-4"},{value:"N-3",label:"N-3"},{value:"N-2",label:"N-2"}],u=(e,t)=>{let s=new FormData;s.append("title",e.courseTitle),s.append("description",e.courseDescription),s.append("category",e.courseCategory),s.append("price",e.coursePrice.toString()),s.append("status",e.courseStatus?"Published":"Draft");let r=t.map(e=>({...e,chapters:e.chapters.map(e=>({...e,video:e.video}))}));return s.append("sections",JSON.stringify(r)),s},p=async(e,t,s)=>{let r=e.map(e=>({...e,chapters:e.chapters.map(e=>({...e}))}));for(let e=0;e<r.length;e++)for(let a=0;a<r[e].chapters.length;a++){let n=r[e].chapters[a];if(n.video instanceof File&&"video/mp4"===n.video.type)try{let i=await m(n,t,r[e].sectionId,s);r[e].chapters[a]=i}catch(e){console.error("Failed to upload video for chapter ".concat(n.chapterId,":"),e)}}return r};async function m(e,t,s,r){let a=e.video;try{let{uploadUrl:n,videoUrl:c}=await r({courseId:t,sectionId:s,chapterId:e.chapterId,fileName:a.name,fileType:a.type}).unwrap();return await fetch(n,{method:"PUT",headers:{"Content-Type":a.type},body:a}),i.A.success("Video uploaded successfully for chapter ".concat(e.chapterId)),{...e,video:c}}catch(t){throw console.error("Failed to upload video for chapter ".concat(e.chapterId,":"),t),t}}},51994:(e,t,s)=>{"use strict";s.d(t,{Bi:()=>f,Dx:()=>x,Ie:()=>g,Ky:()=>m,NG:()=>_,PW:()=>p,S5:()=>y,_c:()=>l,a_:()=>u,hi:()=>c,iL:()=>h,kD:()=>o,mG:()=>d,ym:()=>v});var r=s(36074),a=s(8507),n=s(27776);let i=async(e,t,s)=>{let a=(0,r.ni)({baseUrl:"http://localhost:8001",prepareHeaders:async e=>{var t,s;let r=await (null===(s=window.Clerk)||void 0===s?void 0:null===(t=s.session)||void 0===t?void 0:t.getToken());return r&&e.set("Authorization","Bearer ".concat(r)),e}});try{var i,c,o,l;let r=await a(e,t,s);if(r.error){let e=r.error.data,t=(null==e?void 0:e.message)||r.error.status.toString()||"An error occurred";n.A.error("Error: ".concat(t))}if(e.method&&"GET"!==e.method){let e=null===(l=r.data)||void 0===l?void 0:l.message;e&&n.A.success(e)}if(r.data)r.data=r.data.data;else if((null===(i=r.error)||void 0===i?void 0:i.status)===204||(null===(o=r.meta)||void 0===o?void 0:null===(c=o.response)||void 0===c?void 0:c.status)===24)return{data:null};return r}catch(e){return{error:{status:"FETCH_ERROR",error:e instanceof Error?e.message:"Unknown error"}}}},c=(0,a.LC)({baseQuery:i,reducerPath:"api",tagTypes:["Courses","Users","UserCourseProgress"],endpoints:e=>({updateUser:e.mutation({query:e=>{let{userId:t,...s}=e;return{url:"users/clerk/".concat(t),method:"PUT",body:s}},invalidatesTags:["Users"]}),getCourses:e.query({query:e=>{let{category:t}=e;return{url:"courses",params:{category:t}}},providesTags:["Courses"]}),getCourse:e.query({query:e=>"courses/".concat(e),providesTags:(e,t,s)=>[{type:"Courses",id:s}]}),createCourse:e.mutation({query:e=>({url:"courses",method:"POST",body:e}),invalidatesTags:["Courses"]}),updateCourse:e.mutation({query:e=>{let{courseId:t,formData:s}=e;return{url:"courses/".concat(t),method:"PUT",body:s}},invalidatesTags:(e,t,s)=>{let{courseId:r}=s;return[{type:"Courses",id:r}]}}),deleteCourse:e.mutation({query:e=>({url:"courses/".concat(e),method:"DELETE"}),invalidatesTags:["Courses"]}),getUploadVideoUrl:e.mutation({query:e=>{let{courseId:t,sectionId:s,chapterId:r,fileName:a,fileType:n}=e;return{url:"courses/".concat(t,"/sections/").concat(s,"/chapters/").concat(r,"/get-upload-url"),method:"POST",body:{fileName:a,fileType:n}}}}),getTransactions:e.query({query:e=>"transactions?userId=".concat(e)}),createStripePaymentIntent:e.mutation({query:e=>{let{amount:t}=e;return{url:"/transactions/stripe/payment-intent",method:"POST",body:{amount:t}}}}),createTransaction:e.mutation({query:e=>({url:"transactions",method:"POST",body:e})}),getUserEnrolledCourses:e.query({query:e=>"users/course-progress/".concat(e,"/enrolled-courses"),providesTags:["Courses","UserCourseProgress"]}),getUserCourseProgress:e.query({query:e=>{let{userId:t,courseId:s}=e;return"users/course-progress/".concat(t,"/courses/").concat(s)},providesTags:["UserCourseProgress"]}),updateUserCourseProgress:e.mutation({query:e=>{let{userId:t,courseId:s,progressData:r}=e;return{url:"users/course-progress/".concat(t,"/courses/").concat(s),method:"PUT",body:r}},invalidatesTags:["UserCourseProgress"],async onQueryStarted(e,t){let{userId:s,courseId:r,progressData:a}=e,{dispatch:n,queryFulfilled:i}=t,o=n(c.util.updateQueryData("getUserCourseProgress",{userId:s,courseId:r},e=>{Object.assign(e,{...e,sections:a.sections})}));try{await i}catch(e){o.undo()}}})})}),{useUpdateUserMutation:o,useCreateCourseMutation:l,useUpdateCourseMutation:d,useDeleteCourseMutation:u,useGetCoursesQuery:p,useGetCourseQuery:m,useGetUploadVideoUrlMutation:h,useGetTransactionsQuery:v,useCreateTransactionMutation:x,useCreateStripePaymentIntentMutation:y,useGetUserEnrolledCoursesQuery:f,useGetUserCourseProgressQuery:g,useUpdateUserCourseProgressMutation:_}=c}},e=>{var t=t=>e(e.s=t);e.O(0,[5267,979,5456,4595,7138,7712,6615,7130,6215,1744],()=>t(67202)),_N_E=e.O()}]);